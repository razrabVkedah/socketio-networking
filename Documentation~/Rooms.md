Игрок может одновременно находиться максимум в одной комнате. Конечно, [socket.io](http://socket.io) соединение устанавливает с клиентом при запуске игры, но при входе в комнату клиент подписывается на дополнительные события сервера, связанные с real-time игровым процессом.

# Создание комнаты

У сервера есть ограничения на максимально возможное количество комнат. Если уже создано максимальное число комнат, очередной клиент не сможет создать еще одну.

Клиент создавший комнату автоматически становится её хостом (на данный момент сервер не является авторитарным и вся логика делегируется одному из клиентов).

При создании комнаты хост может указать максимальное число игроков.

# Присоединение к комнате

Когда пользователь открывает раздел с доступными комнатами, он подписывается на событие all-rooms - с определённой периодичностью сервер оповещает клиента о состоянии комнат. Также клиент может спровоцировать сервер, чтобы сервер оповестил клиента о комнатах прямо сейчас (для этого клиент вызывает события update-rooms).

Немаловажным является отображение пинга для каждой из комнат. У любого пользователя есть класс, отвечающий за расчёт пинга, - получается клиент знает пинг между собой и сервером. Остаётся узнать пинги между сервером и каждым из хостов комнат - эта информация хранится на сервере (сервер не вычисляет эти пинги при каждой запросе от очередного клиента, желающего вступить в комнату) и отправляется вместе с данными о комнатах. Клиенту остаётся сложить свой пинг с пингом для каждой комнаты и получить итоговые пинги.

Если количество участников в комнате меньше максимума, то пользователь может присоединиться к комнате.

# Выход из комнаты

Клиент может добровольно выйти из комнаты. Если клиент не является хостом, то никаких трудностей не возникает. Но если клиент всё таки является хостом, то сервер должен попытаться выбрать нового хоста (либо это клиент, присоединившийся вторым, либо это клиент с минимальным пингом - причём второй вариант предпочтителен) и синхронизировать данные, чтобы возобновить полноценную работу комнаты. Но возможно возникнут трудности в реализации данной логики для не авторитарного сервера. Пока данная логика не реализована, комната будет удаляться при отключении хоста.

В случае, когда в комнате не остаётся ни одного участника, комната удаляется.

# Установка повторного соединения

бла-бла-бла

# Хранение данных

Первой идеей при реализации комнату было для каждой комнаты создавать объект на сервере и хранить там нужные данные. Но всегда существует вероятность, что с сервером что-то произойдёт и данные о комнатах будут утеряны. Возможно, есть смысл хранить некоторую информацию в базе данных